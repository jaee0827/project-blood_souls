using System.Collections;
using UnityEngine;

public class PlayerPlatformFall : MonoBehaviour // (?????? ????? ??? ?? ??????)
{
    private bool _isDropping; // ???? ???????? ?????? ???
    public int playerLayer = 6;
    public int platformLayer = 7;

    void Start()
    {
        // ????? ????? ????? ??? (????? ????)
        _isDropping = false;
    }

    void Update()
    {
        if (gameObject.GetComponent<Health>().isDead)
        {
            return;
        }
        
        // ??? ?(S? ??? ??? ????)?? ??????, ???? ???????? ???? ??? ??
        if (Input.GetKey(KeyCode.S) || Input.GetKey(KeyCode.DownArrow))
        {
            if (!_isDropping)
            {
                StartCoroutine(DropDown());
            }
        }
    }

    private IEnumerator DropDown()
    {
        // 1. ???????? ????? ????
        _isDropping = true;

        // 2. ??????? ????? ??????? ???? "????" (???!)
        Physics2D.IgnoreLayerCollision(playerLayer, platformLayer, true);

        // 3. ???? ??? (0.3??) ???? (??????? ????? ???)
        yield return new WaitForSeconds(0.3f);

        // 4. ???? ??? "????"
        Physics2D.IgnoreLayerCollision(playerLayer, platformLayer, false);

        // 5. ???????? ???? ????
        _isDropping = false;
    }
}